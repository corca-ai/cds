{"version":3,"file":"factory.mjs","sources":["../../../styled-system/jsx/factory.mjs"],"sourcesContent":["import { createElement, forwardRef, useMemo } from 'react'\nimport { css, cx, cva } from '../css/index.mjs';\nimport { defaultShouldForwardProp, composeShouldForwardProps, composeCvaFn, getDisplayName } from './factory-helper.mjs';\nimport { splitProps, normalizeHTMLProps } from '../helpers.mjs';\nimport { isCssProperty } from './is-valid-prop.mjs';\n\nfunction styledFn(Dynamic, configOrCva = {}, options = {}) {\n  const cvaFn = configOrCva.__cva__ || configOrCva.__recipe__ ? configOrCva : cva(configOrCva)\n\n  const forwardFn = options.shouldForwardProp || defaultShouldForwardProp\n  const shouldForwardProp = (prop) => forwardFn(prop, cvaFn.variantKeys)\n\n  const defaultProps = Object.assign(\n    options.dataAttr && configOrCva.__name__ ? { 'data-recipe': configOrCva.__name__ } : {},\n    options.defaultProps,\n  )\n\n  const __cvaFn__ = composeCvaFn(Dynamic.__cva__, cvaFn)\n  const __shouldForwardProps__ = composeShouldForwardProps(Dynamic, shouldForwardProp)\n  const __base__ = Dynamic.__base__ || Dynamic\n\n  const StyledComponent = /* @__PURE__ */ forwardRef(function StyledComponent(props, ref) {\n    const { as: Element = __base__, children, ...restProps } = props\n\n    const combinedProps = useMemo(() => Object.assign({}, defaultProps, restProps), [restProps])\n\n    const [htmlProps, forwardedProps, variantProps, styleProps, elementProps] = useMemo(() => {\n      return splitProps(combinedProps, normalizeHTMLProps.keys, __shouldForwardProps__, __cvaFn__.variantKeys, isCssProperty)\n    }, [combinedProps])\n\n    function recipeClass() {\n      const { css: cssStyles, ...propStyles } = styleProps\n      const compoundVariantStyles = __cvaFn__.__getCompoundVariantCss__?.(variantProps)\n      return cx(__cvaFn__(variantProps, false), css(compoundVariantStyles, propStyles, cssStyles), combinedProps.className)\n    }\n\n    function cvaClass() {\n      const { css: cssStyles, ...propStyles } = styleProps\n      const cvaStyles = __cvaFn__.raw(variantProps)\n      return cx(css(cvaStyles, propStyles, cssStyles), combinedProps.className)\n    }\n\n    const classes = configOrCva.__recipe__ ? recipeClass : cvaClass\n\n    return createElement(Element, {\n      ref,\n      ...forwardedProps,\n      ...elementProps,\n      ...normalizeHTMLProps(htmlProps),\n      className: classes(),\n    }, combinedProps.children ?? children)\n  })\n\n  const name = getDisplayName(__base__)\n\n  StyledComponent.displayName = `styled.${name}`\n  StyledComponent.__cva__ = __cvaFn__\n  StyledComponent.__base__ = __base__\n  StyledComponent.__shouldForwardProps__ = shouldForwardProp\n\n  return StyledComponent\n}\n\nfunction createJsxFactory() {\n  const cache = new Map()\n\n  return new Proxy(styledFn, {\n    apply(_, __, args) {\n      return styledFn(...args)\n    },\n    get(_, el) {\n      if (!cache.has(el)) {\n        cache.set(el, styledFn(el))\n      }\n      return cache.get(el)\n    },\n  })\n}\n\nexport const styled = /* @__PURE__ */ createJsxFactory()\n"],"names":["styledFn","Dynamic","configOrCva","options","cvaFn","cva","forwardFn","defaultShouldForwardProp","shouldForwardProp","prop","defaultProps","__cvaFn__","composeCvaFn","__shouldForwardProps__","composeShouldForwardProps","__base__","StyledComponent","forwardRef","props","ref","Element","children","restProps","combinedProps","useMemo","htmlProps","forwardedProps","variantProps","styleProps","elementProps","splitProps","normalizeHTMLProps","isCssProperty","recipeClass","cssStyles","propStyles","compoundVariantStyles","_a","cx","css","cvaClass","cvaStyles","classes","createElement","name","getDisplayName","createJsxFactory","cache","_","__","args","el","styled"],"mappings":";;;;;;;AAMA,SAASA,EAASC,GAASC,IAAc,CAAA,GAAIC,IAAU,CAAA,GAAI;AACzD,QAAMC,IAAQF,EAAY,WAAWA,EAAY,aAAaA,IAAcG,EAAIH,CAAW,GAErFI,IAAYH,EAAQ,qBAAqBI,GACzCC,IAAoB,CAACC,MAASH,EAAUG,GAAML,EAAM,WAAW,GAE/DM,IAAe,OAAO;AAAA,IAC1BP,EAAQ,YAAYD,EAAY,WAAW,EAAE,eAAeA,EAAY,SAAQ,IAAK,CAAE;AAAA,IACvFC,EAAQ;AAAA,EACT,GAEKQ,IAAYC,EAAaX,EAAQ,SAASG,CAAK,GAC/CS,IAAyBC,EAA0Bb,GAASO,CAAiB,GAC7EO,IAAWd,EAAQ,YAAYA,GAE/Be,IAAkC,gBAAAC,EAAW,SAAyBC,GAAOC,GAAK;AACtF,UAAM,EAAE,IAAIC,IAAUL,GAAU,UAAAM,GAAU,GAAGC,EAAS,IAAKJ,GAErDK,IAAgBC,EAAQ,MAAM,OAAO,OAAO,IAAId,GAAcY,CAAS,GAAG,CAACA,CAAS,CAAC,GAErF,CAACG,GAAWC,GAAgBC,GAAcC,GAAYC,CAAY,IAAIL,EAAQ,MAC3EM,EAAWP,GAAeQ,EAAmB,MAAMlB,GAAwBF,EAAU,aAAaqB,CAAa,GACrH,CAACT,CAAa,CAAC;AAElB,aAASU,IAAc;;AACrB,YAAM,EAAE,KAAKC,GAAW,GAAGC,EAAY,IAAGP,GACpCQ,KAAwBC,IAAA1B,EAAU,8BAAV,gBAAA0B,EAAA,KAAA1B,GAAsCgB;AACpE,aAAOW,EAAG3B,EAAUgB,GAAc,EAAK,GAAGY,EAAIH,GAAuBD,GAAYD,CAAS,GAAGX,EAAc,SAAS;AAAA,IACrH;AAED,aAASiB,IAAW;AAClB,YAAM,EAAE,KAAKN,GAAW,GAAGC,EAAY,IAAGP,GACpCa,IAAY9B,EAAU,IAAIgB,CAAY;AAC5C,aAAOW,EAAGC,EAAIE,GAAWN,GAAYD,CAAS,GAAGX,EAAc,SAAS;AAAA,IACzE;AAED,UAAMmB,IAAUxC,EAAY,aAAa+B,IAAcO;AAEvD,WAAOG,EAAcvB,GAAS;AAAA,MAC5B,KAAAD;AAAA,MACA,GAAGO;AAAA,MACH,GAAGG;AAAA,MACH,GAAGE,EAAmBN,CAAS;AAAA,MAC/B,WAAWiB,EAAS;AAAA,IAC1B,GAAOnB,EAAc,YAAYF,CAAQ;AAAA,EACzC,CAAG,GAEKuB,IAAOC,EAAe9B,CAAQ;AAEpC,SAAAC,EAAgB,cAAc,UAAU4B,CAAI,IAC5C5B,EAAgB,UAAUL,GAC1BK,EAAgB,WAAWD,GAC3BC,EAAgB,yBAAyBR,GAElCQ;AACT;AAEA,SAAS8B,IAAmB;AAC1B,QAAMC,IAAQ,oBAAI,IAAK;AAEvB,SAAO,IAAI,MAAM/C,GAAU;AAAA,IACzB,MAAMgD,GAAGC,GAAIC,GAAM;AACjB,aAAOlD,EAAS,GAAGkD,CAAI;AAAA,IACxB;AAAA,IACD,IAAIF,GAAGG,GAAI;AACT,aAAKJ,EAAM,IAAII,CAAE,KACfJ,EAAM,IAAII,GAAInD,EAASmD,CAAE,CAAC,GAErBJ,EAAM,IAAII,CAAE;AAAA,IACpB;AAAA,EACL,CAAG;AACH;AAEY,MAACC,IAAyB,gBAAAN,EAAgB;"}